<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malla - Ingeniería en Telecomunicaciones</title>
  <style>
    :root{
      --bg:#000; /* loro nergo ~ black */
      --text:#eaeaea;
      --card-size:88px;
      --gap:8px;
      --small-font:11px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, system-ui, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:18px;
    }
    h1{font-size:20px;margin:0 0 10px}
    p.lead{margin:0 0 18px;color:#bdbdbd;font-size:13px}

    /* layout */
    .board{display:flex;gap:18px;align-items:flex-start;overflow:auto;padding-bottom:18px}
    .semester{min-width:160px}
    .sem-title{font-size:13px;margin:0 0 8px;color:#cfcfcf}
    .stack{display:flex;flex-direction:column;gap:var(--gap)}

    /* card */
    .card{
      width:var(--card-size);
      height:var(--card-size);
      border-radius:6px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      text-align:center;
      padding:6px;
      font-size:11px;
      line-height:1.05;
      cursor:pointer;
      box-shadow:0 1px 0 rgba(255,255,255,0.04) inset, 0 6px 12px rgba(0,0,0,0.6);
      transition:transform .12s ease, opacity .12s ease, filter .12s ease;
      border:1px solid rgba(255,255,255,0.03);
      position:relative;
    }
    .card.small{font-size:10px;padding:5px}
    .card.disabled{opacity:.32;cursor:not-allowed;transform:scale(.995)}
    .card.completed{outline:3px solid rgba(255,255,255,0.06);filter:grayscale(.0);opacity:0.85}

    /* area colors */
    .area-unidad-basica{background: #f5d442; color:#1a1507} /* amarillo */
    .area-unidad-profesional{background:#2b8ce6;color:white} /* azul */
    .area-unidad-integracion{background:#2bd46b;color:#07320a} /* verde */
    .area-requisitos-graduacion{background:#e74c3c;color:white} /* rojo */
    .area-itinerario-radio{background:#ff9a2e;color:#2b1200} /* naranja */
    .area-itinerario-comunicacion{background:#9fe9ff;color:#003041} /* celeste */
    .area-itinerario-telematica{background:#ffb6da;color:#3b0020} /* rosado */

    /* tooltip */
    .tooltip{position:absolute;left:calc(var(--card-size) + 10px);top:0;min-width:220px;background:#111;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);font-size:12px;color:#ddd;display:none;z-index:40}
    .card:hover .tooltip{display:block}

    /* controls */
    .controls{display:flex;gap:10px;align-items:center;margin:10px 0 16px}
    button, .btn{background:#222;color:var(--text);border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:6px;cursor:pointer}
    .legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .legend .item{display:flex;gap:6px;align-items:center;font-size:12px}
    .legend .sw{width:14px;height:14px;border-radius:3px;display:inline-block}

    /* responsive */
    @media (max-width:900px){
      :root{--card-size:76px}
      .semester{min-width:120px}
    }
  </style>
</head>
<body>
  <h1>Malla - Ingeniería en Telecomunicaciones</h1>
  <p class="lead">Interfaz con fondo negro. Haz clic en una asignatura para marcarla como cursada. Las asignaturas bloqueadas (por prerrequisitos) aparecerán atenuadas hasta que cumplas sus prerrequisitos.</p>

  <div class="controls">
    <button id="reset">Restablecer marcado</button>
    <div style="margin-left:8px;color:#bdbdbd;font-size:13px">Mostrar: </div>
    <select id="filter">
      <option value="all">Todas</option>
      <option value="enabled">Habilitadas</option>
      <option value="completed">Cursadas</option>
      <option value="blocked">Bloqueadas</option>
    </select>
  </div>

  <div class="board" id="board" aria-live="polite">
    <!-- columns generadas por JS -->
  </div>

  <div style="margin-top:12px">
    <strong>Leyenda:</strong>
    <div class="legend">
      <div class="item"><span class="sw" style="background:#f5d442"></span> Unidad Básica</div>
      <div class="item"><span class="sw" style="background:#2b8ce6"></span> Unidad Profesional</div>
      <div class="item"><span class="sw" style="background:#2bd46b"></span> Unidad de Integración</div>
      <div class="item"><span class="sw" style="background:#e74c3c"></span> Requisitos Para Graduación</div>
      <div class="item"><span class="sw" style="background:#ff9a2e"></span> Itinerario Radiocomunicación</div>
      <div class="item"><span class="sw" style="background:#9fe9ff"></span> Itinerario Comunicación</div>
      <div class="item"><span class="sw" style="background:#ffb6da"></span> Itinerario Telemática</div>
    </div>
  </div>

  <script>
    /* datos de la malla (IDs y prerrequisitos referenciados como en la lista del usuario) */
    const materias = [
      {id:1,name:'Álgebra Lineal (MATD113)',horas:144,creditos:3,area:'Unidad Básica',prereqs:[]},
      {id:2,name:'Cálculo de una Variable (MATD123)',horas:144,creditos:3,area:'Unidad Básica',prereqs:[]},
      {id:3,name:'Mecánica Newtoniana (FISD134)',horas:192,creditos:4,area:'Unidad Básica',prereqs:[]},
      {id:4,name:'Química General (QUID143)',horas:144,creditos:3,area:'Unidad Básica',prereqs:[]},
      {id:5,name:'Herramientas Informáticas (ICOD111)',horas:48,creditos:1,area:'Unidad Básica',prereqs:[]},
      {id:6,name:'Comunicación Oral y Escrita (CSHD11)',horas:48,creditos:1,area:'Unidad Básica',prereqs:[]},
      {id:7,name:'Deportes (DEPD110)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      {id:8,name:'Ecuaciones Diferenciales Ordinarias (MATD213)',horas:144,creditos:3,area:'Unidad Básica',prereqs:[1,2]},
      {id:9,name:'Probabilidad y Estadística Básica (MATD223)',horas:144,creditos:3,area:'Unidad Básica',prereqs:[2]},
      {id:10,name:'Cálculo Vectorial (IEED232)',horas:96,creditos:2,area:'Unidad Básica',prereqs:[2]},
      {id:11,name:'Fundamentos de Electromagnetismo (IEED242)',horas:96,creditos:2,area:'Unidad Básica',prereqs:[3]},
      {id:12,name:'Programación (IEED252)',horas:96,creditos:2,area:'Unidad Básica',prereqs:[5]},
      {id:13,name:'Análisis Socioeconómico y Político del Ecuador (CSHD211)',horas:48,creditos:1,area:'Unidad Básica',prereqs:[]},
      {id:14,name:'Electrotecnia (IEED272)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[]},
      {id:15,name:'Inglés B1 (IEXD200)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:16,name:'Clubes (SOCD210)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:17,name:'Metodología de Estudio (IEED210)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      {id:18,name:'Matemática Avanzada (IEED312)',horas:96,creditos:2,area:'Unidad Básica',prereqs:[8,10]},
      {id:19,name:'Sistemas Digitales (IEED323)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[14]},
      {id:20,name:'Dispositivos Electrónicos (IEED333)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[14]},
      {id:21,name:'Teoría Electromagnética (IEED342)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[10,11]},
      {id:22,name:'Fundamentos de Circuitos Eléctricos (IEE353)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[8,14]},
      {id:23,name:'Asignatura de Artes y Humanidades (CSHD300)',horas:48,creditos:0,area:'Unidad Profesional',prereqs:[]},
      {id:24,name:'Matemática Discreta (IEED371)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[9,19]},

      {id:25,name:'Instalación Eléctrica y Comunicación (IEED413)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[22]},
      {id:26,name:'Análisis de Señales Discretas para Comunicaciones (TELD423)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[18]},
      {id:27,name:'Circuitos Electrónicos (IEED433)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[20]},
      {id:28,name:'Programación Avanzada (ITID433)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[12]},
      {id:29,name:'Sistema Operativo Linux (TELD452)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[12]},
      {id:30,name:'Asignatura de Economía y Sociedad (CSHD400)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[]},

      {id:31,name:'Fundamentos de Comunicaciones (TELD513)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[26]},
      {id:32,name:'Teoría de la Información y Codificación (TELD522)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[26]},
      {id:33,name:'Procesamiento Digital de Señales (TELD532)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[26]},
      {id:34,name:'Sistemas Embebidos (ITID553)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[19,29]},
      {id:35,name:'Sistemas de Transmisión (TLED553)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[21]},
      {id:36,name:'Sistemas de Cableado Estructural (ITID512)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[25]},
      {id:37,name:'Gestión Organizacional (ADM511)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[]},
      {id:38,name:'Asignatura de Comunicación (CSHD500)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      {id:39,name:'Comunicación Digital (TELD613)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[31]},
      {id:40,name:'Telemática Básica (TELD623)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[31]},
      {id:41,name:'Electrónica de Radiofrecuencia (TELD633)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[27,35]},
      {id:42,name:'Aplicación con Sistemas Embebidos (TELD642)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[33,34]},
      {id:43,name:'Propagación y Antenas (TELD654)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[35]},

      {id:44,name:'Comunicación Óptica (TELD713)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[39]},
      {id:45,name:'Telemática Avanzada (TELD723)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[40]},
      {id:46,name:'Comunicaciones Inalámbricas (TELD733)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[39,34]},
      {id:47,name:'Telefonía IP (TELD743)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[40]},
      {id:48,name:'Ingeniería de Microondas (TELD752)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[41,43]},
      {id:49,name:'Gestión de Procesos y Calidad (ADMD611)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[37]},
      {id:50,name:'Emprendimiento (ADMD700)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      {id:51,name:'Itinerario Básico (TELD800)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[42,45,48]},
      {id:52,name:'Redes Ópticas (TELD823)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[44]},
      {id:53,name:'Introducción a Diseño de Redes (TELD833)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[45]},
      {id:54,name:'Sistemas Celulares (TELD843)',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[45]},
      {id:55,name:'Fundamentos de Seguridad (TELD852)',horas:96,creditos:0,area:'Unidad Profesional',prereqs:[45]},
      {id:56,name:'Ingeniería Financiera (TELD711)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[37]},
      {id:57,name:'Diseño de Proyectos de Telecomunicaciones (TELD871)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[]},
      {id:58,name:'Formulación y Evaluación de Proyectos (ADMD800)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:59,name:'Componentes Pasivos de Radiofrecuencia (TELD801)',horas:0,creditos:0,area:'Itinerario Radiocomunicación',prereqs:[51]},
      {id:60,name:'Técnicas Avanzadas de Procesamiento Digital de Señales (TELD802)',horas:0,creditos:0,area:'Itinerario Comunicación',prereqs:[51]},
      {id:61,name:'Conmutación y Enrutamiento Avanzado (TELD803)',horas:0,creditos:0,area:'Itinerario Telemática',prereqs:[51]},

      {id:62,name:'Itinerario Avanzado (TELD900)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[51]},
      {id:63,name:'Prácticas Profesionales (PRLD105)',horas:240,creditos:5,area:'Unidad Profesional',prereqs:[]},
      {id:64,name:'Práctica de Servicio Comunitario (PSCD202)',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[]},
      {id:65,name:'Marco Regulatorio de Telecomunicaciones (TELD941)',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[48]},
      {id:66,name:'Trabajo de Integración Curricular / Examen Complexivo (TITD201)',horas:240,creditos:5,area:'Unidad de Integración Curricular',prereqs:[]},
      {id:67,name:'Ecología y Ambiente (AMBD900)',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:68,name:'Componentes Activos de Radiofrecuencia (TELD901)',horas:0,creditos:0,area:'Itinerario Radiocomunicación',prereqs:[59]},
      {id:69,name:'Técnicas Avanzadas de Clasificación de Señales (TELD902)',horas:0,creditos:0,area:'Itinerario Comunicación',prereqs:[60]},
      {id:70,name:'Tecnologías Avanzadas en Redes de Datos (TELD903)',horas:0,creditos:0,area:'Itinerario Telemática',prereqs:[61]},
    ];

    /* semestres organizados (para visual) */
    const semestres = [
      {title:'AÑO 1 - SEMESTRE 1', ids:[1,2,3,4,5,6,7]},
      {title:'AÑO 1 - SEMESTRE 2', ids:[8,9,10,11,12,13,14,15,16,17]},
      {title:'AÑO 2 - SEMESTRE 3', ids:[18,19,20,21,22,23,24]},
      {title:'AÑO 2 - SEMESTRE 4', ids:[25,26,27,28,29,30]},
      {title:'AÑO 3 - SEMESTRE 5', ids:[31,32,33,34,35,36,37,38]},
      {title:'AÑO 3 - SEMESTRE 6', ids:[39,40,41,42,43]},
      {title:'AÑO 4 - SEMESTRE 7', ids:[44,45,46,47,48,49,50]},
      {title:'AÑO 4 - SEMESTRE 8', ids:[51,52,53,54,55,56,57,58,59,60,61]},
      {title:'AÑO 5 - SEMESTRE 9', ids:[62,63,64,65,66,67,68,69,70]},
    ];

    /* mapa rápido para acceder por id */
    const mapa = {};
    materias.forEach(m=>mapa[m.id]=m);

    /* area -> css class */
    function areaClass(area){
      switch(area){
        case 'Unidad Básica': return 'area-unidad-basica';
        case 'Unidad Profesional': return 'area-unidad-profesional';
        case 'Unidad de Integración Curricular': return 'area-unidad-integracion';
        case 'Unidad de Integración': return 'area-unidad-integracion';
        case 'Requisitos Para Graduación': return 'area-requisitos-graduacion';
        case 'Itinerario Radiocomunicación': return 'area-itinerario-radio';
        case 'Itinerario Radiocomunicación': return 'area-itinerario-radio';
        case 'Itinerario Comunicación': return 'area-itinerario-comunicacion';
        case 'Itinerario Telemática': return 'area-itinerario-telematica';
        default: return 'area-unidad-profesional';
      }
    }

    /* estado de cursadas (persistencia localStorage) */
    const STORAGE_KEY = 'malla_telecom_cursadas_v1';
    let cursadas = new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'));

    function save(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(cursadas)));
    }

    function allPrereqsDone(m){
      if(!m.prereqs || m.prereqs.length===0) return true;
      return m.prereqs.every(pid=>cursadas.has(pid));
    }

    function buildCard(m){
      const div = document.createElement('div');
      div.className = 'card small '+ areaClass(m.area);
      div.dataset.id = m.id;

      // show only short label: materia line1 and horas/creditos line2
      const short = document.createElement('div');
      short.style.fontWeight='600';
      short.style.fontSize='11px';
      short.textContent = m.name.split('(')[0].trim();

      const meta = document.createElement('div');
      meta.style.fontSize='11px';
      meta.style.marginTop='6px';
      meta.textContent = `${m.horas}h · ${m.creditos}cr`;

      // tooltip with full info
      const tooltip = document.createElement('div');
      tooltip.className='tooltip';
      tooltip.innerHTML = `<strong>${m.name}</strong><br>Horas: ${m.horas} · Créditos: ${m.creditos}<br>Área: ${m.area}<br>Prerrequisitos: ${m.prereqs.length? m.prereqs.join(', '): 'Ninguno'}`;

      div.appendChild(short);
      div.appendChild(meta);
      div.appendChild(tooltip);

      // initial state
      updateCardState(div, m);

      div.addEventListener('click', (e)=>{
        if(div.classList.contains('disabled')) return;
        const id = Number(div.dataset.id);
        if(cursadas.has(id)){
          cursadas.delete(id);
        } else {
          cursadas.add(id);
        }
        save();
        refreshAll();
      });

      return div;
    }

    function updateCardState(cardElem, m){
      const id = m.id;
      cardElem.classList.remove('disabled','completed');
      if(cursadas.has(id)){
        cardElem.classList.add('completed');
        cardElem.style.opacity = '0.9';
      } else {
        // enabled only if all prerrequisitos done
        if(allPrereqsDone(m)){
          // enabled
          cardElem.style.opacity = '';
        } else {
          cardElem.classList.add('disabled');
        }
      }
    }

    function renderBoard(filter='all'){
      const board = document.getElementById('board');
      board.innerHTML='';
      semestres.forEach(sem=>{
        const col = document.createElement('div');
        col.className='semester';
        const title = document.createElement('div');
        title.className='sem-title';
        title.textContent = sem.title;
        const stack = document.createElement('div');
        stack.className='stack';
        sem.ids.forEach(id=>{
          const m = mapa[id];
          if(!m) return;
          const card = buildCard(m);

          // apply filter
          const isCompleted = cursadas.has(id);
          const isEnabled = allPrereqsDone(m) && !isCompleted;
          const isBlocked = !allPrereqsDone(m) && !isCompleted;

          let show=true;
          if(filter==='enabled') show = isEnabled;
          if(filter==='completed') show = isCompleted;
          if(filter==='blocked') show = isBlocked;

          if(show) stack.appendChild(card);
        });
        col.appendChild(title);
        col.appendChild(stack);
        board.appendChild(col);
      });
    }

    function refreshAll(){
      // update existing cards' state if present, otherwise re-render
      document.querySelectorAll('.card').forEach(card=>{
        const id = Number(card.dataset.id);
        const m = mapa[id];
        if(m) updateCardState(card,m);
      });
      // reapply filter
      const filter = document.getElementById('filter').value;
      renderBoard(filter);
    }

    // initial render
    document.getElementById('filter').addEventListener('change', (e)=>{
      renderBoard(e.target.value);
    });
    document.getElementById('reset').addEventListener('click', ()=>{
      if(confirm('¿Restablecer todas las materias marcadas como cursadas?')){
        cursadas = new Set(); save(); renderBoard(document.getElementById('filter').value);
      }
    });

    // render first time
    renderBoard('all');

    // expose for dev console
    window.__malla = {materias, semestres, mapa, cursadas};
  </script>
</body>
</html>
