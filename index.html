<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Curricular - Ingeniería en Telecomunicaciones</title>
    <style>
        :root {
            --unidad-basica: #e1ff00;
            --unidad-profesional: #0a12ff;
            --unidad-integracion: #1dff1a;
            --requisitos-graduacion: #ff0505;
            --itinerario-radiocomunicacion: #ff8d0a;
            --itinerario-comunicacion: #09b3ec;
            --itinerario-telematica: #f434c1;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        
        h1 {
            margin: 0;
            font-size: 24px;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .filter-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .stats {
            background-color: white;
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 18px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        button {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        button:hover {
            opacity: 0.9;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            padding: 5px 10px;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .malla-container {
            overflow-x: auto;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .malla-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            min-width: 1000px;
        }
        
        .semestre-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .curso {
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            color: white;
            font-weight: bold;
            font-size: 12px;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .curso:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .curso.selected {
            box-shadow: 0 0 0 3px #333;
        }
        
        .curso-name {
            margin-bottom: 5px;
            line-height: 1.2;
        }
        
        .curso-code {
            font-size: 10px;
            opacity: 0.8;
        }
        
        .curso-sct {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background-color: rgba(0,0,0,0.2);
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 10px;
        }
        
        .prereq-line {
            position: absolute;
            background-color: #333;
            z-index: -1;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 5px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        
        .close-modal {
            float: right;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .curso-info {
            margin-top: 20px;
        }
        
        .info-row {
            display: flex;
            margin-bottom: 10px;
        }
        
        .info-label {
            font-weight: bold;
            width: 150px;
        }
        
        .info-value {
            flex: 1;
        }
        
        .prereq-list {
            list-style-type: none;
            padding: 0;
        }
        
        .prereq-item {
            padding: 5px;
            margin-bottom: 5px;
            border-radius: 3px;
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }
            
            .filter-controls {
                flex-direction: column;
            }
            
            .stats {
                justify-content: space-around;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Malla Curricular - Ingeniería en Telecomunicaciones</h1>
        </header>
        
        <div class="controls">
            <div class="filter-controls">
                <button id="select-all" class="btn-primary">Seleccionar todo</button>
                <button id="clear-selection" class="btn-danger">Limpiar selección</button>
                <button id="show-selected" class="btn-success">Mostrar solo seleccionados</button>
                <button id="reset-view" class="btn-warning">Restablecer vista</button>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-cursos">0</div>
                    <div class="stat-label">Total cursos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="selected-cursos">0</div>
                    <div class="stat-label">Seleccionados</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="total-sct">0</div>
                    <div class="stat-label">Total SCT</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="selected-sct">0</div>
                    <div class="stat-label">SCT seleccionados</div>
                </div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--unidad-basica);"></div>
                <span>Unidad Básica</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--unidad-profesional);"></div>
                <span>Unidad Profesional</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--unidad-integracion);"></div>
                <span>Unidad Integración</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--requisitos-graduacion);"></div>
                <span>Requisitos Graduación</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--itinerario-radiocomunicacion);"></div>
                <span>Itinerario Radiocom.</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--itinerario-comunicacion);"></div>
                <span>Itinerario Comunicación</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: var(--itinerario-telematica);"></div>
                <span>Itinerario Telemática</span>
            </div>
        </div>
        
        <div class="malla-container">
            <div class="malla-grid" id="malla-grid">
                <!-- Aquí se generará la malla curricular dinámicamente -->
            </div>
        </div>
        
        <div id="curso-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal">&times;</span>
                <div class="curso-info" id="curso-info">
                    <!-- Aquí se mostrará la información detallada del curso -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos de la malla curricular
        const mallaData = {
            "data": [
                {
                    "id": 1,
                    "preRequisitos": [],
                    "name": "Algebra Lineal MATD113",
                    "area": "Unidad Básica",
                    "directas": 144,
                    "sct": 3,
                    "year": 1,
                    "semestre": 1,
                    "selected": false
                },
                {
                    "id": 2,
                    "preRequisitos": [1, 10],
                    "name": "Ecuaciones Diferenciales Ordinarias MATD213",
                    "area": "Unidad Básica",
                    "directas": 144,
                    "sct": 3,
                    "year": 1,
                    "semestre": 2,
                    "selected": false
                },
                {
                    "id": 3,
                    "preRequisitos": [2, 16],
                    "name": "Matemática Avanzada IEED312",
                    "area": "Unidad Básica",
                    "directas": 96,
                    "sct": 2,
                    "year": 2,
                    "semestre": 3,
                    "selected": false
                },
                {
                    "id": 4,
                    "preRequisitos": [24],
                    "name": "Instalación Eléctrica y Comunicación IEED413",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "year": 2,
                    "semestre": 4,
                    "selected": false
                },
                {
                    "id": 5,
                    "preRequisitos": [27],
                    "name": "Fundamentos de Comunicaciones TELD513",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "year": 3,
                    "semestre": 5,
                    "selected": false
                },
                {
                    "id": 6,
                    "preRequisitos": [5],
                    "name": "Comunicación Digital TELD613",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "year": 3,
                    "semestre": 6,
                    "selected": false
                },
                {
                    "id": 7,
                    "preRequisitos": [6],
                    "name": "Comunicación Ópticas TELD713",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "year": 4,
                    "semestre": 7,
                    "selected": false
                },
                {
                    "id": 8,
                    "preRequisitos": [39, 42, 45],
                    "name": "Itinerario Basico TELD800",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "year": 4,
                    "semestre": 8,
                    "selected": false
                },
                {
                    "id": 9,
                    "preRequisitos": [8],
                    "name": "Itinerario Avanzado TELD900",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "year": 5,
                    "semestre": 9,
                    "selected": false
                },
                {
                    "id": 10,
                    "preRequisitos": [],
                    "name": "Calculo de una variable MATD123",
                    "area": "Unidad Básica",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 1,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 11,
                    "preRequisitos": [],
                    "name": "Mecánica Newtoniana FISD134",
                    "area": "Unidad Básica",
                    "directas": 192,
                    "sct": 4,
                    "semestre": 1,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 12,
                    "preRequisitos": [],
                    "name": "Química General QUID143",
                    "area": "Unidad Básica",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 1,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 13,
                    "preRequisitos": [],
                    "name": "Herramientas Informáticas ICOD111",
                    "area": "Unidad Básica",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 1,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 14,
                    "preRequisitos": [],
                    "name": "Comunicacion Oral y Escrita CSHD11",
                    "area": "Unidad Básica",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 1,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 15,
                    "preRequisitos": [10],
                    "name": "Probabilidad y Estadística Básica MATD223",
                    "area": "Unidad Básica",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 16,
                    "preRequisitos": [10],
                    "name": "Calculo Vectorial IEED232",
                    "area": "Unidad Básica",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 17,
                    "preRequisitos": [11],
                    "name": "Fundamentos de Electromagnetismo IEED242",
                    "area": "Unidad Básica",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 18,
                    "preRequisitos": [13],
                    "name": "Programación IEED252",
                    "area": "Unidad Básica",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 19,
                    "preRequisitos": [],
                    "name": "Análisis Socioeconómico y Político del Ecuador CSHD211",
                    "area": "Unidad Básica",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 20,
                    "preRequisitos": [],
                    "name": "Electrotecnia IEED272",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 21,
                    "preRequisitos": [20],
                    "name": "Sistema Digitales IEED323",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 3,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 22,
                    "preRequisitos": [20],
                    "name": "Dispositivos Electrónicos IEED333",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 3,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 23,
                    "preRequisitos": [16, 17],
                    "name": "Teoría Electromagnética IEED342",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 3,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 24,
                    "preRequisitos": [2, 20],
                    "name": "Fundamentos de Circuitos Eléctricos IEE353",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 3,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 25,
                    "preRequisitos": [],
                    "name": "Asignatura de Artes y Humanidades CSHD300",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 0,
                    "semestre": 3,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 26,
                    "preRequisitos": [15, 21],
                    "name": "Matemática Discreta IEED371",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 3,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 27,
                    "preRequisitos": [3],
                    "name": "Análisis de Señales Discretas Para Comunicaciones TELD423",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 4,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 28,
                    "preRequisitos": [22],
                    "name": "Circuitos Electrónicos IEED433",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 4,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 29,
                    "preRequisitos": [18],
                    "name": "Programación Avanzada ITID433",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 4,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 30,
                    "preRequisitos": [18],
                    "name": "Sistema Operativo Linux TELD452",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 4,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 31,
                    "preRequisitos": [],
                    "name": "Asignatura de Economía y Sociedad CSHD400",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 4,
                    "year": 2,
                    "selected": false
                },
                {
                    "id": 32,
                    "preRequisitos": [27],
                    "name": "Teoría de la Información y Codificación TELD522",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 5,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 33,
                    "preRequisitos": [27],
                    "name": "Procesamiento Digital de Señales TELD532",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 5,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 34,
                    "preRequisitos": [21, 30],
                    "name": "Sistema Embebidos ITID553",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 5,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 35,
                    "preRequisitos": [23],
                    "name": "Sistema de Trasmisión TLED553",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 5,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 36,
                    "preRequisitos": [4],
                    "name": "Sistema de Cableado Estructural ITID512",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 5,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 37,
                    "preRequisitos": [5],
                    "name": "Telemática Básica TELD623",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 6,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 38,
                    "preRequisitos": [28, 35],
                    "name": "Electrónica de Radiofrecuencia TELD633",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 6,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 39,
                    "preRequisitos": [33, 34],
                    "name": "Aplicación con Sistemas Embebidos TELD642",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 6,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 40,
                    "preRequisitos": [35],
                    "name": "Propagación y Antenas TELD654",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 6,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 41,
                    "preRequisitos": [],
                    "name": "Gestión Organizacional ADM511",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 6,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 42,
                    "preRequisitos": [37],
                    "name": "Telemática Avanzada TELD723",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 7,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 43,
                    "preRequisitos": [6, 34],
                    "name": "Comunicación Inalámbricas TELD733",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 7,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 44,
                    "preRequisitos": [37],
                    "name": "Telefonia IP TELD743",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 7,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 45,
                    "preRequisitos": [38, 40],
                    "name": "Ingeniería de Microondas TELD752",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 7,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 46,
                    "preRequisitos": [41],
                    "name": "Gestión de Procesos y Calidad ADMD611",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 7,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 47,
                    "preRequisitos": [7],
                    "name": "Redes Ópticas TELD823",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 48,
                    "preRequisitos": [42],
                    "name": "Introcucion a Diseños de Redes TELD833",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 49,
                    "preRequisitos": [42],
                    "name": "Sistema Celulares TELD843",
                    "area": "Unidad Profesional",
                    "directas": 144,
                    "sct": 3,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 50,
                    "preRequisitos": [42],
                    "name": "Fundamentos de Seguridad TELD852",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 0,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 51,
                    "preRequisitos": [41],
                    "name": "Ingeniería Financiera TELD711",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 52,
                    "preRequisitos": [],
                    "name": "Diseño de Proyectos de Telecomunicaciones TELD871",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 53,
                    "preRequisitos": [],
                    "name": "Practicas Profesionales PRLD105",
                    "area": "Unidad Profesional",
                    "directas": 240,
                    "sct": 5,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 54,
                    "preRequisitos": [],
                    "name": "Practica de Servicio Comunitario PSCD202",
                    "area": "Unidad Profesional",
                    "directas": 96,
                    "sct": 2,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 55,
                    "preRequisitos": [45],
                    "name": "Marco Regulatorio de los Servicios de Telecomunicaciones TELD941",
                    "area": "Unidad Profesional",
                    "directas": 48,
                    "sct": 1,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 56,
                    "preRequisitos": [],
                    "name": "Trabajo de Integración curricular / Examen de Carácter Complexivo TITD201",
                    "area": "Unidad de Integración Curricular",
                    "directas": 240,
                    "sct": 5,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 57,
                    "preRequisitos": [],
                    "name": "Ingles B1 IEXD200",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 58,
                    "preRequisitos": [],
                    "name": "Deportes DEPD110",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 1,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 59,
                    "preRequisitos": [],
                    "name": "Clubes SOCD210",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 60,
                    "preRequisitos": [],
                    "name": "Metodología de Estudio IEED210",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 2,
                    "year": 1,
                    "selected": false
                },
                {
                    "id": 61,
                    "preRequisitos": [],
                    "name": "Asignatura de Comunicación CSHD500",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 5,
                    "year": 3,
                    "selected": false
                },
                {
                    "id": 62,
                    "preRequisitos": [],
                    "name": "Emprendimiento ADMD700",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 7,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 63,
                    "preRequisitos": [],
                    "name": "Formulación y Evaluación de Proyectos ADMD800",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 64,
                    "preRequisitos": [],
                    "name": "Ecologia y Ambiente AMBD900",
                    "area": "Requisitos Para Graduacion",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 65,
                    "preRequisitos": [8],
                    "name": "Componentes Pasivos de Radiofrecuencia TELD801",
                    "area": "Itinerario Radiocomunicación",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 66,
                    "preRequisitos": [65],
                    "name": "Componentes Activos de Radiofrecuencia TELD901",
                    "area": "Itinerario Radiocomunicación",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 67,
                    "preRequisitos": [8],
                    "name": "Técnicas Avanzadas de Procesamiento Digital de Señales TELD802",
                    "area": "Itinerario Comunicación",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 68,
                    "preRequisitos": [67],
                    "name": "Técnicas Avanzadas De Clasificación de Señales TELD902",
                    "area": "Itinerario Comunicación",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                },
                {
                    "id": 69,
                    "preRequisitos": [8],
                    "name": "Conmutación y Enrutamiento Avanzado TELD803",
                    "area": "Itinerario Telemática",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 8,
                    "year": 4,
                    "selected": false
                },
                {
                    "id": 70,
                    "preRequisitos": [],
                    "name": "Tecnología Avanzadas en Redes de Datos TELD903",
                    "area": "Itinerario Telemática",
                    "directas": 0,
                    "sct": 0,
                    "semestre": 9,
                    "year": 5,
                    "selected": false
                }
            ],
            "mallaAreas": [
                {
                    "name": "Unidad Básica",
                    "backgroundColor": "#e1ff00"
                },
                {
                    "name": "Unidad Profesional",
                    "backgroundColor": "#0a12ff"
                },
                {
                    "name": "Unidad de Integración Curricular",
                    "backgroundColor": "#1dff1a"
                },
                {
                    "name": "Requisitos Para Graduacion",
                    "backgroundColor": "#ff0505"
                },
                {
                    "name": "Itinerario Radiocomunicación",
                    "backgroundColor": "#ff8d0a"
                },
                {
                    "name": "Itinerario Comunicación",
                    "backgroundColor": "#09b3ec"
                },
                {
                    "name": "Itinerario Telemática",
                    "backgroundColor": "#f434c1"
                }
            ]
        };

        // Variables globales
        let cursos = mallaData.data;
        let areas = mallaData.mallaAreas;
        let showOnlySelected = false;
        let selectedCourses = [];

        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            renderMalla();
            updateStats();
            setupEventListeners();
        });

        // Renderizar la malla curricular
        function renderMalla() {
            const mallaGrid = document.getElementById('malla-grid');
            mallaGrid.innerHTML = '';

            // Crear encabezados de semestre
            for (let sem = 1; sem <= 9; sem++) {
                const semestreHeader = document.createElement('div');
                semestreHeader.className = 'semestre-header';
                semestreHeader.textContent = `Semestre ${sem}`;
                mallaGrid.appendChild(semestreHeader);
            }

            // Agregar cursos a la malla
            cursos.forEach(curso => {
                if (showOnlySelected && !curso.selected) return;

                const cursoElement = document.createElement('div');
                cursoElement.className = 'curso';
                
                // Establecer el color según el área
                const area = areas.find(a => a.name === curso.area);
                cursoElement.style.backgroundColor = area ? area.backgroundColor : '#ccc';
                
                // Extraer código del curso
                const parts = curso.name.split(' ');
                const code = parts[parts.length - 1];
                const name = parts.slice(0, -1).join(' ');
                
                cursoElement.innerHTML = `
                    <div class="curso-name">${name}</div>
                    <div class="curso-code">${code}</div>
                    <div class="curso-sct">${curso.sct} SCT</div>
                `;
                
                if (curso.selected) {
                    cursoElement.classList.add('selected');
                }
                
                // Posicionar en el semestre correcto (semestre 1 está en la columna 1)
                const gridColumn = curso.semestre;
                cursoElement.style.gridColumn = gridColumn;
                cursoElement.style.gridRow = '2'; // Debajo del encabezado
                
                // Guardar ID en el elemento para referencia
                cursoElement.dataset.id = curso.id;
                
                // Evento click para seleccionar/deseleccionar
                cursoElement.addEventListener('click', function() {
                    toggleCourseSelection(curso.id);
                });
                
                // Evento doble click para mostrar detalles
                cursoElement.addEventListener('dblclick', function() {
                    showCourseDetails(curso.id);
                });
                
                mallaGrid.appendChild(cursoElement);
            });

            // Dibujar líneas de prerrequisitos
            drawPrerequisiteLines();
        }

        // Dibujar líneas de prerrequisitos
        function drawPrerequisiteLines() {
            // Primero limpiar cualquier línea existente
            document.querySelectorAll('.prereq-line').forEach(el => el.remove());

            cursos.forEach(curso => {
                if (curso.preRequisitos && curso.preRequisitos.length > 0) {
                    const cursoElement = document.querySelector(`.curso[data-id="${curso.id}"]`);
                    if (!cursoElement) return;

                    const cursoRect = cursoElement.getBoundingClientRect();
                    const cursoX = cursoRect.left + cursoRect.width / 2;
                    const cursoY = cursoRect.top;

                    curso.preRequisitos.forEach(prereqId => {
                        const prereqElement = document.querySelector(`.curso[data-id="${prereqId}"]`);
                        if (!prereqElement) return;

                        const prereqRect = prereqElement.getBoundingClientRect();
                        const prereqX = prereqRect.left + prereqRect.width / 2;
                        const prereqY = prereqRect.top + prereqRect.height;

                        // Crear elemento de línea
                        const line = document.createElement('div');
                        line.className = 'prereq-line';

                        // Calcular posición y tamaño de la línea
                        const left = Math.min(prereqX, cursoX);
                        const top = prereqY;
                        const width = Math.abs(cursoX - prereqX);
                        const height = cursoY - prereqY;

                        line.style.left = `${left}px`;
                        line.style.top = `${top}px`;
                        line.style.width = `${width}px`;
                        line.style.height = `${height}px`;

                        // Agregar flecha en el extremo inferior
                        line.style.borderLeft = '2px solid #333';
                        line.style.borderBottom = '2px solid #333';
                        line.style.borderRight = 'none';
                        line.style.borderTop = 'none';

                        document.body.appendChild(line);
                    });
                }
            });
        }

        // Alternar selección de curso
        function toggleCourseSelection(courseId) {
            const curso = cursos.find(c => c.id === courseId);
            if (!curso) return;

            curso.selected = !curso.selected;
            
            // Actualizar lista de cursos seleccionados
            if (curso.selected) {
                selectedCourses.push(courseId);
            } else {
                selectedCourses = selectedCourses.filter(id => id !== courseId);
            }
            
            // Volver a renderizar y actualizar estadísticas
            renderMalla();
            updateStats();
        }

        // Mostrar detalles del curso
        function showCourseDetails(courseId) {
            const curso = cursos.find(c => c.id === courseId);
            if (!curso) return;

            const modal = document.getElementById('curso-modal');
            const modalContent = document.getElementById('curso-info');
            
            // Obtener nombres de prerrequisitos
            const prereqNames = curso.preRequisitos.map(id => {
                const prereq = cursos.find(c => c.id === id);
                return prereq ? prereq.name : '';
            }).filter(name => name !== '');
            
            // Construir contenido del modal
            modalContent.innerHTML = `
                <h2>${curso.name}</h2>
                <div class="info-row">
                    <div class="info-label">Área:</div>
                    <div class="info-value">${curso.area}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Semestre:</div>
                    <div class="info-value">${curso.semestre} (Año ${curso.year})</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Horas directas:</div>
                    <div class="info-value">${curso.directas}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Créditos SCT:</div>
                    <div class="info-value">${curso.sct}</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Prerrequisitos:</div>
                    <div class="info-value">
                        ${prereqNames.length > 0 ? 
                            `<ul class="prereq-list">${prereqNames.map(name => `<li class="prereq-item">${name}</li>`).join('')}</ul>` : 
                            'Ninguno'}
                    </div>
                </div>
            `;
            
            // Mostrar modal
            modal.style.display = 'block';
            
            // Cerrar modal al hacer click en la X
            document.querySelector('.close-modal').onclick = function() {
                modal.style.display = 'none';
            };
            
            // Cerrar modal al hacer click fuera del contenido
            window.onclick = function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            };
        }

        // Actualizar estadísticas
        function updateStats() {
            const totalCursos = cursos.length;
            const selectedCursos = cursos.filter(c => c.selected).length;
            const totalSCT = cursos.reduce((sum, curso) => sum + curso.sct, 0);
            const selectedSCT = cursos.filter(c => c.selected).reduce((sum, curso) => sum + curso.sct, 0);
            
            document.getElementById('total-cursos').textContent = totalCursos;
            document.getElementById('selected-cursos').textContent = selectedCursos;
            document.getElementById('total-sct').textContent = totalSCT;
            document.getElementById('selected-sct').textContent = selectedSCT;
        }

        // Configurar event listeners para los controles
        function setupEventListeners() {
            // Seleccionar todos los cursos
            document.getElementById('select-all').addEventListener('click', function() {
                cursos.forEach(curso => {
                    curso.selected = true;
                    if (!selectedCourses.includes(curso.id)) {
                        selectedCourses.push(curso.id);
                    }
                });
                renderMalla();
                updateStats();
            });
            
            // Limpiar selección
            document.getElementById('clear-selection').addEventListener('click', function() {
                cursos.forEach(curso => {
                    curso.selected = false;
                });
                selectedCourses = [];
                renderMalla();
                updateStats();
            });
            
            // Mostrar solo seleccionados
            document.getElementById('show-selected').addEventListener('click', function() {
                showOnlySelected = true;
                renderMalla();
            });
            
            // Restablecer vista
            document.getElementById('reset-view').addEventListener('click', function() {
                showOnlySelected = false;
                renderMalla();
            });
            
            // Redibujar líneas cuando cambia el tamaño de la ventana
            window.addEventListener('resize', function() {
                drawPrerequisiteLines();
            });
        }
    </script>
</body>
</html>
