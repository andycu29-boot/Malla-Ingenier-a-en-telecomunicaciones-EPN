<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malla Curricular - Ing. Telecomunicaciones EPN</title>
  <style>
    :root{
      --bg:#000;
      --text:#eaeaea;
      --card-width:120px;
      --card-height:80px;
      --gap:6px;
      --small-font:9px;
      --graduacion-color: #d2b48c;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:Inter, system-ui, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:12px;
      max-width:100vw;
      overflow-x:hidden;
      transition: background 0.3s ease;
      display: grid;
      grid-template-areas: 
        "header header"
        "progress ."
        "search search"
        "controls controls"
        "board board"
        "legend legend"
        "theme theme";
      gap: 12px;
    }
    
    /* Estilos de fondo */
    body.black-bg {
      background: #000;
      --text: #eaeaea;
    }
    body.green-gradient-bg {
      background: linear-gradient(135deg, #000 0%, #001a00 50%, #004d00 100%);
      --text: #eaeaea;
    }
    body.pink-gradient-bg {
      background: linear-gradient(135deg, #000 0%, #1a001a 50%, #4d004d 100%);
      --text: #eaeaea;
    }
    body.purple-gradient-bg {
      background: linear-gradient(135deg, #000 0%, #0a001a 50%, #2a004d 100%);
      --text: #eaeaea;
    }

    .header {
      grid-area: header;
      position: sticky;
      top: 0;
      background: var(--bg);
      padding: 10px 0;
      z-index: 100;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    h1{
      font-size:18px;
      margin:0 0 10px;
      text-align:center;
    }
    p.lead{
      margin:0 0 12px;
      color:#bdbdbd;
      font-size:12px;
      text-align:center;
    }

    /* layout compacto */
    .board{
      grid-area: board;
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(var(--card-width), 1fr));
      gap:10px;
      padding-bottom:12px;
    }
    .semester{
      background:rgba(255,255,255,0.03);
      border-radius:6px;
      padding:8px;
      border:1px solid rgba(255,255,255,0.06);
    }
    .sem-title{
      font-size:12px;
      margin:0 0 8px;
      color:#cfcfcf;
      font-weight:600;
      text-align:center;
      padding:4px;
      background:rgba(255,255,255,0.08);
      border-radius:4px;
    }
    .stack{
      display:flex;
      flex-direction:column;
      gap:var(--gap);
    }

    /* card con toda la información */
    .card{
      width:100%;
      min-height:var(--card-height);
      border-radius:6px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      padding:6px;
      font-size:10px;
      line-height:1.3;
      cursor:pointer;
      box-shadow:0 1px 0 rgba(255,255,255,0.04) inset, 0 4px 8px rgba(0,0,0,0.3);
      transition:all 0.12s ease;
      border:1px solid rgba(255,255,255,0.08);
      position:relative;
      overflow:hidden;
    }
    .card.disabled{
      opacity:0.4;
      cursor:not-allowed;
      filter:grayscale(0.8);
      background:rgba(0,0,0,0.3) !important;
    }
    .card.completed{
      outline:2px solid rgba(255,255,255,0.1);
      filter:brightness(1.1);
    }
    .card.completed::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        to top left,
        transparent calc(50% - 5px),
        rgba(231, 76, 60, 0.95),
        transparent calc(50% + 5px)
      );
      transform: rotate(-10deg);
      z-index: 0;
      width: 150%;
      height: 150%;
      left: -25%;
      top: -25%;
    }

    /* area colors */
    .area-unidad-basica{background: #f5d442; color:#1a1507}
    .area-unidad-profesional{background:#2b8ce6;color:white}
    .area-unidad-integracion{background:#2bd46b;color:#07320a}
    .area-requisitos-graduacion{background:var(--graduacion-color);color:#3a2a0f}
    .area-itinerario-radio{background:#ff9a2e;color:#2b1200}
    .area-itinerario-comunicacion{background:#9fe9ff;color:#003041}
    .area-itinerario-telematica{background:#ffb6da;color:#3b0020}

    /* info de la materia - Texto centrado */
    .card-name{
      font-weight:600;
      font-size:11px;
      margin-bottom:3px;
      position:relative;
      z-index:1;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .card-code{
      font-size:9px;
      color:rgba(0,0,0,0.7);
      margin-bottom:4px;
      position:relative;
      z-index:1;
      text-align: center;
    }
    .card-meta{
      display:flex;
      justify-content:space-between;
      font-size:9px;
      margin-top:auto;
      position:relative;
      z-index:1;
    }

    /* controls */
    .controls{
      grid-area: controls;
      display:flex;
      gap:8px;
      align-items:center;
      margin:8px 0 12px;
      flex-wrap:wrap;
      justify-content:center;
    }
    button, .btn{
      background:#222;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.1);
      padding:6px 10px;
      border-radius:6px;
      cursor:pointer;
      font-size:12px;
      transition:all 0.12s ease;
    }
    button:hover{background:#333}
    button.reset-btn {
      background: #e74c3c;
      color: white;
    }
    button.reset-btn:hover {
      background: #c0392b;
    }
    select{
      background:#222;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.1);
      padding:6px 8px;
      border-radius:6px;
      font-size:12px;
    }
    .search-container {
      grid-area: search;
      width: 100%;
      margin: 10px 0;
      display: flex;
      justify-content: center;
    }
    #search {
      width: 100%;
      max-width: 400px;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.1);
      background: #222;
      color: var(--text);
    }

    /* Resumen de progreso - Parte derecha */
    .progress-summary {
      grid-area: progress;
      background: rgba(255,255,255,0.05);
      border-radius: 6px;
      padding: 8px;
      border: 1px solid rgba(255,255,255,0.1);
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 6px;
      text-align: center;
      font-size: 11px;
      height: fit-content;
      margin-left: auto;
      margin-top: 10px;
      width: fit-content;
    }
    .progress-summary h3 {
      grid-column: 1 / -1;
      margin: 0 0 4px;
      font-size: 12px;
      color: #cfcfcf;
    }
    .progress-summary div {
      font-size: 10px;
    }
    .progress-summary .value {
      font-weight: bold;
      font-size: 12px;
      color: #f5d442;
      margin-bottom: 2px;
    }

    /* Leyenda - Parte inferior */
    .legend{
      grid-area: legend;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:12px;
      justify-content: center;
      font-size: 11px;
    }
    .legend .item{
      display:flex;
      gap:6px;
      align-items:center;
      font-size:11px;
      background:rgba(255,255,255,0.05);
      padding:3px 6px;
      border-radius:3px;
      border:1px solid rgba(255,255,255,0.1);
    }
    .legend .sw{
      width:12px;
      height:12px;
      border-radius:2px;
    }

    /* Selector de fondos - Posición inferior derecha */
    .bg-selector {
      grid-area: theme;
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      gap: 8px;
      background: rgba(0,0,0,0.7);
      padding: 8px;
      border-radius: 20px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
      z-index: 1000;
    }
    .bg-option {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.2s ease;
    }
    .bg-option:hover {
      transform: scale(1.1);
    }
    .bg-option.selected {
      border-color: var(--text);
    }
    .bg-option[data-bg="black"] {
      background: #000;
    }
    .bg-option[data-bg="green-gradient"] {
      background: linear-gradient(135deg, #000 0%, #001a00 50%, #004d00 100%);
    }
    .bg-option[data-bg="pink-gradient"] {
      background: linear-gradient(135deg, #000 0%, #1a001a 50%, #4d004d 100%);
    }
    .bg-option[data-bg="purple-gradient"] {
      background: linear-gradient(135deg, #000 0%, #0a001a 50%, #2a004d 100%);
    }

    /* responsive */
    @media (max-width:600px){
      :root{
        --card-width:100px;
        --card-height:70px;
      }
      body {
        grid-template-areas: 
          "header header"
          "progress progress"
          "search search"
          "controls controls"
          "board board"
          "legend legend"
          "theme theme";
      }
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      .progress-summary {
        margin: 10px auto;
      }
      .bg-selector {
        bottom: 10px;
        right: 10px;
        gap: 6px;
        padding: 6px;
      }
      .bg-option {
        width: 20px;
        height: 20px;
      }
    }
  </style>
</head>
<body class="black-bg">
  <div class="header">
    <h1>Malla Curricular - Ingeniería en Telecomunicaciones EPN</h1>
    <p class="lead"></p>
  </div>

  <!-- Progreso en parte derecha -->
  <div class="progress-summary">
    <h3>Progreso</h3>
    <div>
      <div class="value" id="completed-courses">0</div>
      <div>Aprobados</div>
    </div>
    <div>
      <div class="value" id="completion-percentage">0%</div>
      <div>Completado</div>
    </div>
    <div>
      <div class="value" id="completed-credits">0</div>
      <div>Créditos</div>
    </div>
    <div>
      <div class="value" id="completed-hours">0</div>
      <div>Horas</div>
    </div>
  </div>

  <div class="search-container">
    <input type="text" id="search" placeholder="Buscar materia por nombre o código...">
  </div>

  <div class="controls">
    <button id="reset" class="reset-btn">Limpiar todo</button>
    <div style="color:#bdbdbd;font-size:12px">Mostrar:</div>
    <select id="filter">
      <option value="all">Todas</option>
      <option value="enabled">Habilitadas</option>
      <option value="completed">Cursadas</option>
      <option value="blocked">Bloqueadas</option>
    </select>
  </div>

  <div class="board" id="board" aria-live="polite">
    <!-- columns generadas por JS -->
  </div>

  <!-- Leyenda en parte inferior -->
  <div class="legend">
    <div class="item"><span class="sw" style="background:#f5d442"></span> Básica</div>
    <div class="item"><span class="sw" style="background:#2b8ce6"></span> Profesional</div>
    <div class="item"><span class="sw" style="background:#2bd46b"></span> Integración</div>
    <div class="item"><span class="sw" style="background:var(--graduacion-color)"></span> Graduación</div>
    <div class="item"><span class="sw" style="background:#ff9a2e"></span> Radiocom.</div>
    <div class="item"><span class="sw" style="background:#9fe9ff"></span> Comunicación</div>
    <div class="item"><span class="sw" style="background:#ffb6da"></span> Telemática</div>
  </div>

  <!-- Selector de fondos en posición inferior derecha -->
  <div class="bg-selector">
    <div class="bg-option selected" data-bg="black" title="Fondo negro"></div>
    <div class="bg-option" data-bg="green-gradient" title="Degradado verde"></div>
    <div class="bg-option" data-bg="pink-gradient" title="Degradado rosado"></div>
    <div class="bg-option" data-bg="purple-gradient" title="Degradado morado"></div>
  </div>

  <script>
    /* datos de la malla completa */
    const materias = [
      // === SEMESTRE 1 ===
      {id:1,name:'Álgebra Lineal',codigo:'MATD113',horas:144,creditos:3,area:'Unidad Básica',prereqs:[]},
      {id:2,name:'Cálculo de una Variable',codigo:'MATD123',horas:144,creditos:3,area:'Unidad Básica',prereqs:[]},
      {id:3,name:'Mecánica Newtoniana',codigo:'FISD134',horas:192,creditos:4,area:'Unidad Básica',prereqs:[]},
      {id:4,name:'Química General',codigo:'QUID143',horas:144,creditos:3,area:'Unidad Básica',prereqs:[]},
      {id:5,name:'Herramientas Informáticas',codigo:'ICOD111',horas:48,creditos:1,area:'Unidad Básica',prereqs:[]},
      {id:6,name:'Comunicación Oral y Escrita',codigo:'CSHD11',horas:48,creditos:1,area:'Unidad Básica',prereqs:[]},
      {id:7,name:'Deportes',codigo:'DEPD110',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      // === SEMESTRE 2 ===
      {id:8,name:'Ecuaciones Diferenciales Ordinarias',codigo:'MATD213',horas:144,creditos:3,area:'Unidad Básica',prereqs:[1,2]},
      {id:9,name:'Probabilidad y Estadística Básica',codigo:'MATD223',horas:144,creditos:3,area:'Unidad Básica',prereqs:[2]},
      {id:10,name:'Cálculo Vectorial',codigo:'IEED232',horas:96,creditos:2,area:'Unidad Básica',prereqs:[2]},
      {id:11,name:'Fundamentos de Electromagnetismo',codigo:'IEED242',horas:96,creditos:2,area:'Unidad Básica',prereqs:[3]},
      {id:12,name:'Programación',codigo:'IEED252',horas:96,creditos:2,area:'Unidad Básica',prereqs:[5]},
      {id:13,name:'Análisis Socioeconómico y Político del Ecuador',codigo:'CSHD211',horas:48,creditos:1,area:'Unidad Básica',prereqs:[]},
      {id:14,name:'Electrotecnia',codigo:'IEED272',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[]},
      {id:15,name:'Inglés B1',codigo:'IEXD200',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:16,name:'Clubes',codigo:'SOCD210',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:17,name:'Metodología de Estudio',codigo:'IEED210',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      // === SEMESTRE 3 ===
      {id:18,name:'Matemática Avanzada',codigo:'IEED312',horas:96,creditos:2,area:'Unidad Básica',prereqs:[8,10]},
      {id:19,name:'Sistemas Digitales',codigo:'IEED323',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[14]},
      {id:20,name:'Dispositivos Electrónicos',codigo:'IEED333',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[14]},
      {id:21,name:'Teoría Electromagnética',codigo:'IEED342',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[10,11]},
      {id:22,name:'Fundamentos de Circuitos Eléctricos',codigo:'IEE353',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[8,14]},
      {id:23,name:'Asignatura de Artes y Humanidades',codigo:'CSHD300',horas:48,creditos:0,area:'Unidad Profesional',prereqs:[]},
      {id:24,name:'Matemática Discreta',codigo:'IEED371',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[9,19]},

      // === SEMESTRE 4 ===
      {id:25,name:'Instalación Eléctrica y Comunicación',codigo:'IEED413',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[22]},
      {id:26,name:'Análisis de Señales Discretas para Comunicaciones',codigo:'TELD423',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[18]},
      {id:27,name:'Circuitos Electrónicos',codigo:'IEED433',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[20]},
      {id:28,name:'Programación Avanzada',codigo:'ITID433',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[12]},
      {id:29,name:'Sistema Operativo Linux',codigo:'TELD452',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[12]},
      {id:30,name:'Asignatura de Economía y Sociedad',codigo:'CSHD400',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[]},

      // === SEMESTRE 5 ===
      {id:31,name:'Fundamentos de Comunicaciones',codigo:'TELD513',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[26]},
      {id:32,name:'Teoría de la Información y Codificación',codigo:'TELD522',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[26]},
      {id:33,name:'Procesamiento Digital de Señales',codigo:'TELD532',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[26]},
      {id:34,name:'Sistemas Embebidos',codigo:'ITID553',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[19,29]},
      {id:35,name:'Sistemas de Transmisión',codigo:'TLED553',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[21]},
      {id:36,name:'Sistemas de Cableado Estructural',codigo:'ITID512',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[25]},
      {id:38,name:'Asignatura de Comunicación',codigo:'CSHD500',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      // === SEMESTRE 6 ===
      {id:39,name:'Comunicación Digital',codigo:'TELD613',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[31]},
      {id:40,name:'Telemática Básica',codigo:'TELD623',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[31]},
      {id:41,name:'Electrónica de Radiofrecuencia',codigo:'TELD633',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[27,35]},
      {id:42,name:'Aplicación con Sistemas Embebidos',codigo:'TELD642',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[33,34]},
      {id:43,name:'Propagación y Antenas',codigo:'TELD654',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[35]},
      {id:37,name:'Gestión Organizacional',codigo:'ADM511',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[]},

      // === SEMESTRE 7 ===
      {id:44,name:'Comunicación Óptica',codigo:'TELD713',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[39]},
      {id:45,name:'Telemática Avanzada',codigo:'TELD723',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[40]},
      {id:46,name:'Comunicaciones Inalámbricas',codigo:'TELD733',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[39,34]},
      {id:47,name:'Telefonía IP',codigo:'TELD743',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[40]},
      {id:48,name:'Ingeniería de Microondas',codigo:'TELD752',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[41,43]},
      {id:49,name:'Gestión de Procesos y Calidad',codigo:'ADMD611',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[37]},
      {id:50,name:'Emprendimiento',codigo:'ADMD700',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},

      // === SEMESTRE 8 ===
      {id:51,name:'Itinerario Básico',codigo:'TELD800',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[42,45,48]},
      {id:52,name:'Redes Ópticas',codigo:'TELD823',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[44]},
      {id:53,name:'Introducción a Diseño de Redes',codigo:'TELD833',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[45]},
      {id:54,name:'Sistemas Celulares',codigo:'TELD843',horas:144,creditos:3,area:'Unidad Profesional',prereqs:[45]},
      {id:55,name:'Fundamentos de Seguridad',codigo:'TELD852',horas:96,creditos:0,area:'Unidad Profesional',prereqs:[45]},
      {id:56,name:'Ingeniería Financiera',codigo:'TELD711',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[37]},
      {id:57,name:'Diseño de Proyectos de Telecomunicaciones',codigo:'TELD871',horas:48,creditos:1,area:'Unidad Profesional',prereqs:[]},
      {id:58,name:'Formulación y Evaluación de Proyectos',codigo:'ADMD800',horas:0,creditos:0,area:'Requisitos Para Graduación',prereqs:[]},
      {id:59,name:'Componentes Pasivos de Radiofrecuencia',codigo:'TELD801',horas:0,creditos:0,area:'Itinerario Radiocomunicación',prereqs:[51]},
      {id:60,name:'Técnicas Avanzadas de Procesamiento Digital de Señales',codigo:'TELD802',horas:0,creditos:0,area:'Itinerario Comunicación',prereqs:[51]},
      {id:61,name:'Conmutación y Enrutamiento Avanzado',codigo:'TELD803',horas:0,creditos:0,area:'Itinerario Telemática',prereqs:[51]},

      // === SEMESTRE 9 ===
      {id:62,name:'Itinerario Avanzado',codigo:'TELD900',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[51]},
      {id:63,name:'Prácticas Profesionales',codigo:'PRLD105',horas:240,creditos:5,area:'Unidad Profesional',prereqs:[]},
      {id:64,name:'Práctica de Servicio Comunitario',codigo:'PSCD202',horas:96,creditos:2,area:'Unidad Profesional',prereqs:[]},
      {id:65,name:'Marco Regu
